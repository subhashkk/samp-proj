$(function() {
    $('select[data-route]').on('change', function (e) {
        var data = $(e.target).data();
        var route = [data.route, data.method].join('/');
        var stub = $(e.target).val();
        setStub(route, stub);
    });

    $('#environment-form select').on('change', function (e) {
        $(this).closest('form').submit();
    });
});

function setStub(route, stub) {
    $.ajax({
        url: '/services/setRoute',
        method: 'GET',
        dataType: 'json',
        data: {
            route: route,
            stub: stub
        }
    })
}
